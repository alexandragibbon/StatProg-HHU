<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Topics in Econometrics and Data Science: Tutorial 4</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="tutorial_4_files/libs/clipboard/clipboard.min.js"></script>
<script src="tutorial_4_files/libs/quarto-html/quarto.js"></script>
<script src="tutorial_4_files/libs/quarto-html/popper.min.js"></script>
<script src="tutorial_4_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="tutorial_4_files/libs/quarto-html/anchor.min.js"></script>
<link href="tutorial_4_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="tutorial_4_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="tutorial_4_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="tutorial_4_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="tutorial_4_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#section-1-pandas" id="toc-section-1-pandas" class="nav-link active" data-scroll-target="#section-1-pandas">Section 1: <code>Pandas</code></a>
  <ul class="collapse">
  <li><a href="#exercise-1-pandas-dataframes" id="toc-exercise-1-pandas-dataframes" class="nav-link" data-scroll-target="#exercise-1-pandas-dataframes">Exercise 1: Pandas DataFrames</a></li>
  </ul></li>
  <li><a href="#section-2-data-visualization" id="toc-section-2-data-visualization" class="nav-link" data-scroll-target="#section-2-data-visualization">Section 2: Data Visualization</a>
  <ul class="collapse">
  <li><a href="#exercise-1-basic-visualization-with-matplotlib-and-seaborn" id="toc-exercise-1-basic-visualization-with-matplotlib-and-seaborn" class="nav-link" data-scroll-target="#exercise-1-basic-visualization-with-matplotlib-and-seaborn">Exercise 1: Basic visualization with <code>matplotlib</code> and <code>seaborn</code></a></li>
  </ul></li>
  <li><a href="#section-3-basics-of-statistics" id="toc-section-3-basics-of-statistics" class="nav-link" data-scroll-target="#section-3-basics-of-statistics">Section 3: Basics of Statistics</a>
  <ul class="collapse">
  <li><a href="#exercise-1-normal-distribution" id="toc-exercise-1-normal-distribution" class="nav-link" data-scroll-target="#exercise-1-normal-distribution">Exercise 1: Normal distribution</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Topics in Econometrics and Data Science: Tutorial 4</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="general-note" class="level4">
<h4 class="anchored" data-anchor-id="general-note">General Note</h4>
<p>You will very likely find the solution to these exercises online. We, however, strongly encourage you to work on these exercises without doing so. Understanding someone else’s solution is very different from coming up with your own. Use the lecture notes and try to solve the exercises independently.</p>
<!--Traditionally, the first program you write in a new language is called "Hello World!". Use the `print()` statement to display "*Hello World!*" on the screen.

* **Hint**: `help(print)` -->
<!--
## Agenda
The agenda of tutorial one is close the structure of lecture 1.

* Values and data types
    - Arithmetic operators
    - Statements and expressions
    - Operations for strings / formatting strings
    - Tuples
    - Lists / methods for lists
    - Dictionaries
    - Composition
    - Error Handling
    - Functions
    - Conditional execution
    - Recursion
    - Loops
* Files, Modules and Classes
    - Files
    - Classes
    - Modules
        - General
        - The `math` module
* `NumPy`
    - Basics
    - Linear Algebra
* `Pandas`
    - Creating DataFrames
    - Sorting, selecting and shaping
    - Handling missing values
    - Grouping
    - Plotting
* Data Visualization
    - `Matplotlib`
    - `Seaborn`
    - `bokeh`
    - `plotly`
-->
</section>
<section id="section-1-pandas" class="level1">
<h1>Section 1: <code>Pandas</code></h1>
<section id="exercise-1-pandas-dataframes" class="level2">
<h2 class="anchored" data-anchor-id="exercise-1-pandas-dataframes">Exercise 1: Pandas DataFrames</h2>

<!--
 a) M and M's Example

A bag of the candy M and M's has many different colors. The table in @fig-mandms contains the targeted color distribution in a bag of M and M's as percentages for various types of packaging. 

![M and M's](figures/MMs.PNG){#fig-mandms}

Enter this table into a `pandas.DataFrame` called `mandms`. Use `pandas` to answer the following questions:

* Which packaging is missing one of the six colours? 

* Confirm that the color shares sum up to 100% for each package type. 
    * **Hint**: `DataFrame.sum()`

* Write a code that displays the colour that is most frequent!
    * **Hint**: `DataFrame.sum()`










a) Brain size data set
-->
<p>Download and load the <code>brain_size.csv</code> data set. The dataset contains a small sample of observations of features (like gender, weight, height and three different IQ-measures) for different individuals.</p>
<p>Before we perform some analysis, we will do some preprocessing.</p>
<ul>
<li><p>Load the data set and drop the column <code>Unnamed: 0</code>.</p></li>
<li><p>Use <code>DataFrame.dropna()</code> to clean your data from entries containing <code>NaN</code> values. How many observations are left after the data cleaning?</p></li>
</ul>
<p>Calculate the following descriptive statistics.</p>
<ul>
<li><p>How many observations/individuals do we have?</p></li>
<li><p>Calculate the means and standard deviations for VIQ, Weight and Height. What is the median of Weight?</p></li>
<li><p>What is the percentage of women in the data set?</p></li>
<li><p>As a primitive approach to determine whether there are differences based on gender, calculate the means of the features above, again conditioned on gender.</p></li>
</ul>
</section>
</section>
<section id="section-2-data-visualization" class="level1">
<h1>Section 2: Data Visualization</h1>
<section id="exercise-1-basic-visualization-with-matplotlib-and-seaborn" class="level2">
<h2 class="anchored" data-anchor-id="exercise-1-basic-visualization-with-matplotlib-and-seaborn">Exercise 1: Basic visualization with <code>matplotlib</code> and <code>seaborn</code></h2>
<p>In this exercise, we will visualize data from a cosinus function. To do so, set up data for a variable <code>x</code> with <code>np.linspace</code>, on which you apply the cosinus function.</p>
<ul>
<li><p>Create a <strong>scatter</strong> plot with <code>matplotlib</code>.</p></li>
<li><p>Create a <strong>line</strong> plot with <code>seaborn</code>.</p></li>
<li><p>Add a sinus function to the graph in <code>matplotlib</code>.</p></li>
<li><p>Add a sinus function to the graph in <code>seaborn</code> via a dashed line.</p></li>
<li><p>Create a random variable that simulates a coin flip. Use the information according to the coin flip to provide a color argument to the scatter plot in <code>matplotlib</code>.</p></li>
<li><p>Put the four different figures as subfigures into one major figure. Save the figure in a file <code>my_plot.png</code>.</p></li>
</ul>
<!-- 
## Exercise 2: Times University Ranking Data

Download and load the Times University Ranking Data (file `timesData.csv`), which collects data on a ranking of international universities.


* Open the data set with `pandas` and have a look at the very first rows. What do you see?

* What has been the best university from Germany in 2016? What is its rank?


* How has the university's ranking changed over time? Create a scatter plot that shows the development of the university's ranking over time.

* Create a graphic that shows the changes in terms of the variables `international`, `research`, `citation`, `income` and `total_score` for this university over time.




-->
<p><!-- * Modify the graphics in a way you like. Can you make them interactive with `plotly` or `bokeh`? Create your own visualization as based on the Times Data set.  --></p>
</section>
</section>
<section id="section-3-basics-of-statistics" class="level1">
<h1>Section 3: Basics of Statistics</h1>
<!--
## Exercise 1: Binomial distribution (no programming required)

1. Find $80\%$ and $90\%$ asymptotic confidence intervals for the expected value $E[X]$ based on  a survey with $n=100$ and $\hat{p}=\frac{1}{n}\sum_{i=1}^n X_i=0.45$.

2. A student wishes to find the proportion of left-handed people. She surveys $100$ fellow students and finds that only $5$ are left-handed. Does a $95\%$ confidence interval contain the value of $p = 0.1$?

3. A survey is taken with $250$ participants, and a $\hat{p}$ of $0.45$. The same survey is repeated with $1000$ participants and the same $\hat{p}$ value is found. Compare the two $95\%$ confidence intervals. What is the relationship? Is the margin of error for the second one four times smaller? 
-->
<!-- 
### Solution:
1. $$\hat{p}\pm \frac{\hat{\sigma}_n}{\sqrt{n}}q_z(0.90) =  (0.3862436, 0.5137564) $$
and
$$\hat{p}\pm \frac{\hat{\sigma}_n}{\sqrt{n}}q_z(0.95) =  (0.3681696, 0.5318304)$$
with $\hat{\sigma}_n^2 = \hat{p}(1-\hat{p})=0.2475$. We pay for the increased confidence with a bigger interval.

2. We have $\hat{p}=0.05$ this implies the $95\%$ confidence interval
$$\hat{p}\pm \frac{\hat{\sigma}_n}{\sqrt{n}}q_z(0.975) = (0.007283575, 0.092716425)$$
with $\hat{\sigma}_n^2 = \hat{p}(1-\hat{p})=0.0475$.

3. $$\hat{p}\pm \frac{\hat{\sigma}_n}{\sqrt{250}}q_z(0.975) =  (0.3883312, 0.5116688) $$
and
$$\hat{p}\pm \frac{\hat{\sigma}_n}{\sqrt{1000}}q_z(0.975) =  (0.4191656, 0.4808344) $$
with $\hat{\sigma}_n^2 = \hat{p}(1-\hat{p})=0.2475$.
The margin of error is 
$$\frac{\hat{\sigma}_n}{\sqrt{1000}}q_z(0.975)=\frac{1}{\sqrt{4}}\frac{\hat{\sigma}_n}{\sqrt{250}}q_z(0.975)= \frac{1}{2}0.06166883$$
only halved.
If the sample size is increased by a factor $c$ the margin of error is decreased by the coefficient $1/\sqrt{c}$ which explains that at some point the cost of accumulating new samples is not very efficient. -->
<section id="exercise-1-normal-distribution" class="level2">
<h2 class="anchored" data-anchor-id="exercise-1-normal-distribution">Exercise 1: Normal distribution</h2>
<ol type="1">
<li><p>A hard-drive manufacturer would like to ensure that the mean time between failures (MTBF) for its new hard drive is <span class="math inline">\(1\)</span> million hours. A stress test is designed that can simulate the workload at a much faster pace. The testers assume that a test lasting <span class="math inline">\(10\)</span> days correlates with the failure time exceeding the <span class="math inline">\(1\)</span>- million-hour mark. In stress tests of <span class="math inline">\(15\)</span> hard drives they found an average of <span class="math inline">\(9.5\)</span> days, with a standard deviation of <span class="math inline">\(1\)</span> day. Does a <span class="math inline">\(90\%\)</span> confidence level include <span class="math inline">\(10\)</span> days?</p></li>
<li><p>Let <span class="math inline">\(X\sim \mathcal{N}(\mu,\sigma^2)\)</span>. We have seen that <span class="math display">\[\sqrt{n}\frac{\bar{X}_n-\mu}{\sigma}\sim \mathcal{N}(0,1)\]</span> and that by replacing the unknown parameter <span class="math inline">\(\sigma^2\)</span> by <span class="math inline">\(\hat{S}^2=\frac{1}{n-1}\sum_{i=1}^n(X_i-\bar{X}_n)^2\)</span> we obtain <span class="math display">\[Z_n:=\sqrt{n}\frac{\bar{X}_n-\mu}{\hat{S}} \xrightarrow[]{\mathcal{D}} Z\sim \mathcal{N}(0,1).\]</span> Therefore we can construct asymptotic confidence intervals for <span class="math inline">\(\mu\)</span>. This means that the confidence interval satisfies the confidence level when <span class="math inline">\(n\)</span> is ‘large’. But what happens when <span class="math inline">\(n\)</span> is ‘small’ and what do we mean by ‘large’? The distribution of <span class="math inline">\(Z_n\)</span> is called <span class="math inline">\(t\)</span>-distribution with <span class="math inline">\(n-1\)</span> degrees of freedom. Compare the densities of the <span class="math inline">\(t\)</span>-distribution and the normal distribution for <span class="math inline">\(n=3,10,25\)</span> and <span class="math inline">\(50\)</span>. What value of <span class="math inline">\(n\)</span> seems ‘large’ enough to say that the two distributions are essentially the same? (Hint: You can use <code>scipy.stats.t</code>)</p></li>
<li><p>In the setting of Exercise 1.2 use a simulation to compare the resulting confidence intervals for <span class="math inline">\(\mu=0\)</span> (choose <span class="math inline">\(\sigma^2=5\)</span>) with confidence level <span class="math inline">\(95\%\)</span>. For each <span class="math inline">\(n\)</span> calculate <span class="math inline">\(1000\)</span> independent samples and count how often the true parameter <span class="math inline">\(\mu\)</span> is contained in the confidence interval.<br> <span class="math inline">\(\Big(\)</span>Hint: Remark that <code>np.var()</code> calculates <span class="math inline">\(\frac{1}{n}\sum_{i=1}^n(X_i-\bar{X}_n)^2\)</span>.<span class="math inline">\(\Big)\)</span></p></li>
</ol>
<!-- 
### Solution:
1. $$9.5 \pm \frac{1}{\sqrt{15}}q_z(0.95) =  (9.075301, 9.924699) $$
or one-sided
$$9.5 + \frac{1}{\sqrt{15}}q_z(0.9) =  (-\infty, 9.830895) $$

2. We have -->
<!-- 

3.The confidence intervals are given by -->
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>